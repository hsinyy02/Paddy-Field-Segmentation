# Paddy-Field-Segmentation
This repository contains source code of my master's thesis project: *A Study on Paddy Field Segmentation and Rice Seedling Detection from UAV Images* [[1]](#1).

**Note:** 
* The version of Python in the project: Python 3.7.6. 
* Due to licensing limitations, `mosaic.png` and the images in `input/` and `dataset/` have been resized in this repository. Copyright of the images which were used in the project belongs to GEOSAT Aerospace & Technology Inc. 

## Project Discription
The project proposed an approach to automatically label rice seedling from UAV images. There are 4 main parts in the proposed method: paddy field segmentation, rice seedling detection, rice seedling labeling, and rice seedling alignment.

##### 1. Paddy Field Segmentation
With the classification tool and three different segmentation algorithms: Watershed algorithm, Felzenszwalb’s algorithm and SLIC algorithm, paddy fields were extracted from the UAV images and the paddy mask image was computed.
`source code: code/get_paddy.py`

##### 2. Rice Seedling Detection
By using blob detection with the paddy mask, rice seedlings were detected from different pre-processing images, which were generated by calculating vegetation indices and image enhancement.
`source code: code/detect_seedling.py`

##### 3. Rice Seedling Labeling
Each detected rice seedling was labeled with an ID number of paddy field zone by utilizing the homography matrix between the input UAV image and the mosaic.
`source code: code/label_seedling.py`

##### 4. Rice Seedling Alignment
In this part, an image stitching algorithm based on rice seedlings was implemented. Then, rice seedling alignment between different UAV images was achieved by using the algorithm.
`source code 1: code/stitching.py`
`source code 2: code/align_seedling.py`

## Preperation
### Dataset
Dataset is built for classification tool in `get_paddy.py`. You can make your own dataset by creating directories, `dataset/img/` & `dataset/label_mask/`.

* You can put binary images whose name format are *`labelName_imgName.jpg`* in `dataset/label_mask/`. The pixel value 1 in a binary image stands for the label area.
* Also, you need to put every image whose filename is *`imgName`* from `dataset/label_mask/` in `dataset/img/`.

## How to Run
* `cd code`
* `chmod +x start.sh`
* `start.sh`

## References
<a href="https://www.airitilibrary.com/Publication/alDetailedMesh1?DocID=U0001-2307202014463300" id="1">[1]</a> 楊欣怡, *透過空拍圖進行稻田區域影像分割與秧苗偵測之研究*, in *工程科學及海洋工程學研究所*. 2021, 國立臺灣大學. p. 1-94.
[1] Yang Hsin-Yi, *A Study on Paddy Field Segmentation and Rice Seedling Detection from UAV Images*, in *Department of Engineering Science and Ocean Engineering*. 2021, National Taiwan University. p. 1-94.